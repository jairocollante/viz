{% extends "eventtia/template.html" %}
{% load staticfiles %}
{% block tarea %}
<script src="https://cdn.jsdelivr.net/npm/vega@5.7.2"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4.0.0-beta.10"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@5.1.3"></script>
<script src="https://d3js.org/d3.v5.min.js"></script>

<section class="ftco-section ftco-bread">
	<div class="container">
		<div class="row no-gutters slider-text justify-content-center align-items-center">
  			<div class="col-md-8 ftco-animate">
    			<h1 class="bread">Tarea secundaria 2_1</h1>
  			</div>
		</div>
	</div>
</section>
			
<section class="ftco-section">
  	<div class="container">
    	<div class="row">    
    	  	<div class="media-body p-2 mt-2">
            	<h4 class="heading mb-3">Identificar patr√≥n de comportamiento en cuanto a demora promedio de llegada a los eventos por tipo de asistente. </h4>
       
          	</div>     
		</div>
		<!--div id="chart">
				<img src="{% static 'eventtia/images/ts_2_1.jpg' %}">
		</div-->

		<div id="vis"></div>

		<script type="text/javascript">
		  var countryname = "Argentina";
		  var weekday = "All";
		  var dataJSON = "https://viz201920.herokuapp.com/ts2_1_backend?attendeetypename=All";
//		  var dataCSV = "https://raw.githubusercontent.com/omarrojas/omarrojas.github.io/master/eventtia/SalidaTarea2.csv"
//		  var dataJSON = "https://viz201920.herokuapp.com/tp2_backend?countryname=Mexico"
		  d3.json(dataJSON)
				.then(function(data) {
					console.log(data)
					var yourVlSpec = {
						"title": 'Delay time by attendee type',
						"data": {values: data},
						"width": 800,
						"height": 350,
						"mark": "line",
						"encoding": {
							"x": {"field": "demora15min", "type": "ordinal", "sort": {"field": "range_order"},
								"axis": {
									"title": "Delay (minutes)"
									}
								},
							"y": {"field": "attendees", "aggregate": "mean", "type": "quantitative"},
							"color": {"field": "attendee_type_name", "type": "nominal"}    
						},
						"selection": {
												"attendee_type": {
													"type": "single",
													"fields": ["attendee_type_name"],
													"bind": {"input": "select",       "name": "Attendee Type ",
														"options": [
															"All",
															"Asistant",
															"Buyers",
															"Consultant",
															"Exhibitors",
															"Regulators",
															"Sellers",
															"Sponsors",
															"Staff",
															"Student",
															"Visitors",
															]
														}
													}
						},
						"transform": [{
							"filter": {"field": "attendee_type_name", "selection": "attendee_type"}
								}]
						}
				;
					vegaEmbed('#vis', yourVlSpec);
				})
				.catch(function(error){
					// handle error   
				})
	
		</script>

		<script type="text/javascript" src="{% static 'eventtia/d3/d3.min.js' %}"> </script>
		<script type="text/javascript" src="{% static 'eventtia/d3/ts2_1.js' %}" > </script>			
	</div>
</section>
	    

{% endblock tarea %}